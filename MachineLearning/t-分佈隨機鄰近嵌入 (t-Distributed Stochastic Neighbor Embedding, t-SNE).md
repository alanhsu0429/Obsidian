# t-分佈隨機鄰近嵌入 (t-Distributed Stochastic Neighbor Embedding, t-SNE)

歡迎來到 t-SNE 的世界！t-SNE 是一種強大的**非線性降維**技術，特別適用於將高維數據可視化到 2D 或 3D 空間。與 PCA 這種線性方法不同，t-SNE 擅長保留數據點之間的**局部結構 (Local Structure)**，即在高維空間中相近的點在低維空間中仍然相近，這使得它在可視化複雜數據集時表現出色。

---

## 核心概念

*   **非線性降維 (Non-linear Dimensionality Reduction)**：t-SNE 能夠捕捉數據中的非線性關係，這使得它能夠揭示 PCA 等線性方法無法發現的複雜結構。
*   **機率分佈匹配 (Probability Distribution Matching)**：t-SNE 的核心思想是將高維空間中數據點之間的相似度轉換為機率分佈，然後在低維空間中找到一個新的機率分佈，使得這兩個分佈盡可能地相似。
    *   **高維空間中的相似度**：使用高斯分佈來衡量數據點 $x_i$ 和 $x_j$ 之間的相似度 $p_{j|i}$。對於每個數據點 $x_i$，它會根據其鄰域的密度自適應地調整高斯分佈的方差，這使得 t-SNE 能夠在不同密度的區域中保持局部結構。
    *   **低維空間中的相似度**：使用學生 t-分佈 (Student's t-distribution) 來衡量低維空間中數據點 $y_i$ 和 $y_j$ 之間的相似度 $q_{j|i}$。學生 t-分佈的「重尾」特性有助於解決「擁擠問題」(Crowding Problem)，即在高維空間中距離適中的點在低維空間中會被擠在一起。
*   **KL 散度 (Kullback-Leibler Divergence)**：t-SNE 透過最小化高維和低維機率分佈之間的 KL 散度來優化低維嵌入。KL 散度衡量了兩個機率分佈之間的差異。
*   **困惑度 (Perplexity)**：t-SNE 的一個重要超參數，可以理解為每個數據點的「有效鄰居數量」。它影響著局部和全局結構的平衡。較小的困惑度會更關注局部結構，較大的困惑度會更關注全局結構。

---

## t-SNE 的工作原理

1.  **構建高維機率分佈**：對於高維空間中的每個數據點 $x_i$，計算它與其他所有數據點 $x_j$ 之間的條件機率 $p_{j|i}$，表示 $x_i$ 會選擇 $x_j$ 作為其鄰居的機率。這個機率是基於高斯分佈的，並且會根據每個點的局部密度進行調整。
2.  **構建低維機率分佈**：在低維空間中，隨機初始化數據點 $y_i$ 的位置。然後，計算低維空間中每個數據點 $y_i$ 與其他所有數據點 $y_j$ 之間的相似度 $q_{j|i}$，使用學生 t-分佈。
3.  **優化**：透過梯度下降等優化算法，最小化高維機率分佈 $P$ 和低維機率分佈 $Q$ 之間的 KL 散度。這個過程會迭代地調整低維數據點 $y_i$ 的位置，直到兩個分佈盡可能地匹配。

---

## 優點與缺點

### 優點

*   **擅長保留局部結構**：能夠在高維數據中發現並可視化複雜的局部結構，例如簇。
*   **處理非線性關係**：是一種非線性降維方法，能夠捕捉數據中的非線性模式。
*   **可視化效果好**：在許多情況下，t-SNE 產生的 2D/3D 可視化圖比 PCA 更能清晰地展示數據的簇結構。

### 缺點

*   **計算成本高**：對於大型數據集，t-SNE 的計算成本非常高，訓練時間可能很長。
*   **對超參數敏感**：困惑度 (Perplexity) 和學習率 (Learning Rate) 等超參數的選擇對結果影響很大，需要仔細調整。
*   **不保留全局結構**：t-SNE 主要關注局部結構，對於全局結構的保留能力較弱。不同簇之間的距離在 t-SNE 圖中可能沒有實際意義。
*   **隨機性**：由於初始化是隨機的，每次運行的結果可能會略有不同。
*   **無法直接用於降維**：t-SNE 主要是用於可視化，不能直接用於將新數據點降維（需要重新運行整個算法）。

---

## 應用場景

*   **數據可視化**：將高維數據（如圖像特徵、文本嵌入）降至 2D 或 3D 進行可視化，以發現簇或異常值。
*   **生物信息學**：單細胞 RNA 測序數據的可視化。
*   **自然語言處理**：詞嵌入 (Word Embeddings) 的可視化。

---

t-SNE 是一種強大且優雅的數據可視化工具，尤其擅長揭示數據中的隱藏結構。理解其機率分佈匹配和局部結構保留的原理是掌握它的關鍵。接下來，我們將簡要介紹流形學習。請持續關注！
