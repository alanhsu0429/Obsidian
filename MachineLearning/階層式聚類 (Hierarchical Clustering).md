# 階層式聚類 (Hierarchical Clustering)

歡迎來到階層式聚類的世界！階層式聚類是一種**非監督式學習**聚類演算法，它旨在建立一個數據點的**層次結構 (Hierarchy)**，而不是像 K-Means 那樣將數據劃分為固定數量的簇。這種層次結構通常以**樹狀圖 (Dendrogram)** 的形式呈現，可以幫助我們理解數據在不同粒度下的分組情況。

---

## 核心概念

*   **樹狀圖 (Dendrogram)**：階層式聚類的結果。它是一個樹狀結構，顯示了數據點是如何逐步合併或分裂的。樹狀圖的垂直軸表示距離或不相似度，水平軸表示數據點或簇。
*   **凝聚式聚類 (Agglomerative Clustering)**：這是最常見的階層式聚類方法，採用「自下而上」(Bottom-Up) 的策略。它從每個數據點作為一個單獨的簇開始，然後逐步將最相似的簇合併，直到所有數據點都屬於一個大簇，或者達到預設的停止條件。
*   **分裂式聚類 (Divisive Clustering)**：採用「自上而下」(Top-Down) 的策略。它從所有數據點作為一個大簇開始，然後逐步將簇分裂成更小的子簇，直到每個數據點都成為一個單獨的簇，或者達到預設的停止條件。
*   **鏈接準則 (Linkage Criterion)**：在凝聚式聚類中，當我們需要合併兩個簇時，需要定義如何衡量兩個簇之間的距離。常見的鏈接準則包括：
    *   **單鏈接 (Single Linkage)**：兩個簇之間的最短距離（即兩個簇中最近的數據點之間的距離）。容易產生「鏈狀」簇。
    *   **全鏈接 (Complete Linkage)**：兩個簇之間的最長距離（即兩個簇中最遠的數據點之間的距離）。傾向於產生緊湊的球形簇。
    *   **平均鏈接 (Average Linkage)**：兩個簇之間所有數據點對的平均距離。
    *   **沃德法 (Ward's Method)**：合併兩個簇，使得合併後簇內方差的增加量最小。傾向於產生大小相似的簇。
*   **距離度量 (Distance Metric)**：用於衡量數據點之間的相似度。最常用的是**歐幾里得距離 (Euclidean Distance)**。

---

## 凝聚式聚類的工作原理

1.  **初始化**：將每個數據點視為一個單獨的簇。
2.  **計算距離**：計算所有簇之間的距離（根據選擇的鏈接準則）。
3.  **合併簇**：將距離最近的兩個簇合併成一個新的簇。
4.  **更新距離**：重新計算新簇與其他所有簇之間的距離。
5.  **重複**：重複步驟 2-4，直到所有數據點都屬於一個大簇。

---

## 優點與缺點

### 優點

*   **無需預先指定簇的數量**：可以透過觀察樹狀圖來決定合適的簇數量。
*   **能夠揭示數據的層次結構**：樹狀圖提供了數據點之間關係的豐富信息，有助於理解數據的內在結構。
*   **可以發現任意形狀的簇**：某些鏈接準則（如單鏈接）可以發現非球形簇。

### 缺點

*   **計算成本高**：對於大型數據集，計算所有數據點之間的距離矩陣和合併過程的計算量非常大，時間複雜度通常為 $O(n^3)$ 或 $O(n^2 \log n)$。
*   **對噪聲和異常值敏感**：特別是單鏈接方法，容易受到噪聲的影響。
*   **一旦合併就無法撤銷**：在凝聚式聚類中，一旦兩個簇被合併，就無法在後續步驟中將它們分開。
*   **難以處理高維數據**：在高維空間中，距離度量變得不那麼有意義。

---

## 應用場景

*   **生物學**：基因表達數據分析、物種分類。
*   **文檔分析**：文檔聚類、主題發現。
*   **市場細分**：根據客戶行為進行分群。
*   **圖像處理**：圖像分割。

---

階層式聚類提供了一種獨特的視角來理解數據的結構，尤其是在我們不確定簇的數量時。理解其樹狀圖和鏈接準則對於成功應用它至關重要。接下來，我們將探討高斯混合模型。請持續關注！
